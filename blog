#!/bin/bash

source "/usr/local/bin/blog_module"

cfg_address=$(sed '1q;d' "./local_config" 2>/dev/null)

# MySQL Constants.
if [ "$cfg_address" == "" ]; then
	MYSQL_HOST="localhost"
else
	MYSQL_HOST="$cfg_address"
fi
MYSQL_USER="root"
MYSQL_DATABASE="blog_entries"
MYSQL_PASS=$(grep "Password: " /usr/bin/local/config.yml | sed 's/.*Password: //')

# Checks if entered action is valid, if not returns a helpful error.
if [ $# -eq 0 ]; then
	echo -e "An argument is mandatory, please run again with one of the following:\n\tblog read\n\tblog write\n\tblog edit\n\tblog delete\n\tblog backup\n\tblog publish"
	exit 1
elif [ $1 == "read" ]; then
	blog_read "$2"
elif [ $1 == "write" ]; then
	blog_write "$2"
elif [ $1 == "edit" ]; then
	blog_edit "$2" "$3"
elif [ $1 == "delete" ]; then
	blog_delete "$2"
elif [ $1 == "backup" ]; then
	blog_backup "$2"
elif [ $1 == "publish" ]; then
	local_publish "$2"
else
	echo -e "You've entered an invalid argument, please run again with one of the following:\n\tblog read\n\tblog write\n\tblog edit\n\tblog delete\n\tblog backup\n\tblog publish"
	exit 1
fi
